{% extends "home.html" %}
{% block title %}View Votes{% endblock %}

{% block content %}
<div class="poll-card">
    <h2>üìä Poll Results</h2>

    <!-- Category Filter -->
    <form method="get" class="filter-form mb-3">
        <label for="category">Select Category:</label>
        <select name="category" id="category" onchange="this.form.submit()">
            <option value="">All Categories</option>
            {% for cat in categories %}
                <option value="{{ cat.id }}" {% if selected_category_id == cat.id %}selected{% endif %}>
                    {{ cat.name }}
                </option>
            {% endfor %}
        </select>
    </form>

    {% if latest_question %}
        <ul class="poll-list">
            {% for question in latest_question %}
                <li class="poll-item">
                    <a href="{% url 'results' question.id %}" class="btn-link">{{ question.question_text }}</a>
                    <span class="muted">({{ question.category.name }})</span>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No polls are available in this category.</p>
    {% endif %}
     
    <div class="pagination ">
    <a href="{% url 'index' %}" class="btn btn-primary mt-3" id="back">‚Üê Back to Home</a>

    {% if latest_question.has_previous %}
        <a href="?{% if selected_category_id %}category={{ selected_category_id }}&{% endif %}page={{ latest_question.previous_page_number }}" class="page-link">Previous</a>
    {% else %}
        <span class="disabled">Previous</span>
    {% endif %}

    {% for i in page_range %}
        {% if i == latest_question.number %}
            <span class="active">{{ i }}</span>
        {% else %}
            <a href="?{% if selected_category_id %}category={{ selected_category_id }}&{% endif %}page={{ i }}" class="page-link">{{ i }}</a>
        {% endif %}
    {% endfor %}

    {% if latest_question.has_next %}
        <a href="?{% if selected_category_id %}category={{ selected_category_id }}&{% endif %}page={{ latest_question.next_page_number }}" class="page-link">Next</a>
    {% else %}
        <span class="disabled">Next</span>
    {% endif %}
</div>



    
</div>
{% endblock %}
